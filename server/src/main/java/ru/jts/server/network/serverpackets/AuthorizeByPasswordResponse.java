package ru.jts.server.network.serverpackets;

import ru.jts.common.network.udp.ServerPacket;
import ru.jts.server.network.Client;

/**
 * @author: Camelion
 * @date: 20.12.13/1:36
 */
public class AuthorizeByPasswordResponse extends ServerPacket<Client> {
    private final short sessionId;

    public AuthorizeByPasswordResponse(short sessionId) {
        this.sessionId = sessionId;
    }

    @Override
    protected void writeImpl() {
        writeShort(0x00);
        writeByte(0xFF);
        writeByte(0x7D);
        writeBytes(0x00, 0x00, 0x00);
        writeShort(sessionId);
        writeByte(0x00); // 0x01 есть открытая сессия 0x00 - нету
        writeShort(0x01);

        writeBytes(0xd1, 0x4e, 0x28, 0x33, 0xc6, 0x40);

        writeBytes((byte) 0x35, (byte) 0x3b, (byte) 0x7c, (byte) 0x34, (byte) 0x45, (byte) 0xbd, (byte) 0x28, (byte) 0xe0, (byte) 0x51, (byte) 0xcb, (byte) 0x2f, (byte) 0x23, (byte) 0x67, (byte) 0x4d, (byte) 0xc2, (byte) 0x8e, (byte) 0xc5, (byte) 0x48, (byte) 0x7b, (byte) 0x5c, (byte) 0x48, (byte) 0x3b, (byte) 0x78, (byte) 0xbc, /* from */ (byte) 0xca, (byte) 0x1e, (byte) 0x4f, (byte) 0x34, (byte) 0xfe, (byte) 0x65, (byte) 0xe5, (byte) 0x35, (byte) 0x64, (byte) 0x50, (byte) 0x67, (byte) 0xf4, (byte) 0x83, (byte) 0x41, (byte) 0xee, (byte) 0xb2, (byte) 0xe5, (byte) 0xd8, (byte) 0x49, (byte) 0x58, (byte) 0xab, (byte) 0x51, (byte) 0xf9, (byte) 0x9b, (byte) 0xad, (byte) 0x57, (byte) 0x39, (byte) 0x0f, (byte) 0x1e, (byte) 0xc1, (byte) 0x11, (byte) 0xc6, (byte) 0x29, (byte) 0x54, (byte) 0xef, (byte) 0x67, (byte) 0xc0, (byte) 0x81, (byte) 0xf6, (byte) 0x85, (byte) 0x92, (byte) 0xb2, (byte) 0x5b, (byte) 0xf9, (byte) 0xd5, (byte) 0x93, (byte) 0xec, (byte) 0xa8, /* to */ (byte) 0x3b, (byte) 0x89, (byte) 0xff, (byte) 0xa9, (byte) 0xd0, (byte) 0xdf, (byte) 0x37, (byte) 0x88, (byte) 0x9e, (byte) 0x92, (byte) 0x1f, (byte) 0x2e, (byte) 0x32, (byte) 0xec, (byte) 0x1d, (byte) 0x2f, (byte) 0x57, (byte) 0x3e, (byte) 0x3d, (byte) 0x60, (byte) 0x2c, (byte) 0xbc, (byte) 0x07, (byte) 0x57, (byte) 0x36, (byte) 0x3f, (byte) 0x17, (byte) 0xa7, (byte) 0x2e, (byte) 0xbe, (byte) 0x9c, (byte) 0x9b, (byte) 0xaf, (byte) 0x13, (byte) 0x50, (byte) 0x09, (byte) 0x65, (byte) 0xb1, (byte) 0x2e, (byte) 0x28, (byte) 0x02, (byte) 0x38, (byte) 0xc5, (byte) 0xc0, (byte) 0x2a, (byte) 0x8a, (byte) 0xdf, (byte) 0x04);
    }
}
